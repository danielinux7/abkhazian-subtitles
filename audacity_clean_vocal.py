import json
import os
from os.path import exists
import time
import pipeclient

f_data = open("caption.json")
data = json.load(f_data)
client = pipeclient.PipeClient()
label = [];
for sub in data:
  name = os.path.abspath(os.getcwd()) + "/" +sub["clip"];
  if(exists(name)):
    start = str(sub["start_sec"]);
    end = str(sub["start_sec"]+10);
    duration = str(sub["end_sec"]-sub["start_sec"]);
    client.write("Import2: Filename="+name)
    client.write("SelectTime: Start=0 End=10")
    client.write("NoiseReduction:")
    if False:
      client.write('FilterCurve:f0="62.77682" f1="70.002037" f10="336.65327" f11="492.91565" f12="591.0509" f13="689.68267" f14="776.07428" f15="889.28813" f16="982.67802" f17="9948.9608" f18="11195.196" f19="12597.538" f2="73.252718" f20="14047.435" f21="16096.677" f3="83.938837" f4="97.946153" f5="119.59827" f6="152.81833" f7="195.26572" f8="221.72906" f9="256.39197" FilterLength="8191" InterpolateLin="0" InterpolationMethod="B-spline" v0="-41.952381" v1="-10.904762" v10="0.031745911" v11="-2.984127" v12="-1.3650789" v13="-0.015872955" v14="0.469841" v15="0.469841" v16="-0.015872955" v17="-0.015872955" v18="-0.031746864" v19="-0.031746864" v2="-5.2349215" v20="-1.7301588" v21="-41.885715" v3="-1.6888895" v4="0.13650751" v5="1.1746035" v6="2" v7="2" v8="1.3015871" v9="0.031745911"')
    else:
      client.write('FilterCurve:f0="79.489043" f1="97.946153" f10="171.96079" f11="188.32275" f12="204.15603" f13="217.38554" f14="235.66227" f15="267.19415" f16="287.07202" f17="313.07034" f18="342.82151" f19="365.7372" f2="98.839376" f20="375.71247" f21="410.97038" f22="441.54447" f23="465.95867" f24="505.13425" f25="554.65966" f26="577.88202" f27="609.83469" f28="667.06329" f29="742.8702" f3="101.41773" f30="834.74595" f31="913.08084" f32="1163.2887" f33="1342.8124" f34="1495.4133" f35="1650.4853" f36="1906.4352" f37="3904.6202" f38="4507.1982" f39="5019.4086" f4="106.0697" f40="7057.9929" f41="7930.9023" f42="8911.7703" f43="11609.196" f44="13182.529" f45="14175.541" f46="15243.355" f47="15664.207" f48="16096.677" f49="16243.472" f5="118.12376" f50="17467.058" f6="130.373" f7="133.92884" f8="149.14889" f9="161.3731" FilterLength="8191" InterpolateLin="0" InterpolationMethod="B-spline" v0="-42.079365" v1="-1.8698416" v10="-0.62857151" v11="0.52380943" v12="1.3904762" v13="1.5968254" v14="1.4730159" v15="-0.053968191" v16="-0.83809543" v17="-2" v18="-0.17142868" v19="1.431746" v2="-0.78095245" v20="1.8857143" v21="2.0095239" v22="1.8031746" v23="0.028571367" v24="-2.9904761" v25="-0.32380962" v26="0.11111116" v27="0.44126987" v28="0.77142859" v29="0.97777772" v3="-0.095238209" v30="0.93650794" v31="0.68888879" v32="-0.34285736" v33="-0.961905" v34="-1.4984126" v35="-1.9936509" v36="-0.019047737" v37="-0.034919739" v38="-2.8190479" v39="0.028571367" v4="0.93650794" v40="-0.012698412" v41="-2.8190479" v42="0.069840431" v43="-0.019047737" v44="-0.24761915" v45="-0.59047627" v46="-1.3904762" v47="-2.3047619" v48="-3.7904763" v49="-5.7714291" v5="1.3492062" v50="-42.076191" v6="1.2666665" v7="1.1015872" v8="-0.42539692" v9="-1.4285717"')
    client.write('Compressor:AttackTime="0.1" NoiseFloor="-40" Normalize="0" Ratio="2" ReleaseTime="1" Threshold="-14" UsePeak="0"')
    client.write("Normalize: PeakLevel=-3")
    client.write("Export2:Filename="+name+".mp3")
    client.write("RemoveTracks:")
